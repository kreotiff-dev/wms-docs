# Размещение товаров

## Обзор процесса

Процесс размещения товаров является логическим продолжением приемки и отвечает за перемещение принятых товаров на постоянные места хранения в складских зонах. Эффективное размещение обеспечивает оптимальное использование складского пространства, быстрый доступ к товарам и минимизацию перемещений при последующей сборке заказов.

## Участники процесса

- **Кладовщик**: выполняет физическое размещение товаров по ячейкам
- **Система WMS**: определяет оптимальные места размещения и контролирует процесс
- **Супервизор склада**: разрешает конфликтные ситуации и корректирует план размещения при необходимости

## Диаграмма процесса

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Подготовка     │     │   Выбор места   │     │   Сканирование  │
│  размещения     ├────►│   хранения      ├────►│   ячейки        │
└─────────────────┘     └─────────────────┘     └────────┬────────┘
                                                         │
                                                         ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│   Завершение    │     │   Обновление    │     │   Физическое    │
│   размещения    │◄────┤   инвентаря     │◄────┤   размещение    │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

## Шаги процесса

### 1. Подготовка размещения

**Описание**: Кладовщик получает доступ к тележке размещения с принятыми товарами и готовится к их размещению на складе.

**Действия**:
- Проверка содержимого тележки размещения
- Планирование маршрута размещения
- Подготовка необходимого оборудования (ТСД, погрузчик при необходимости)

**API Endpoint**: `GET /wms/v1/placement-carts/{id}`

**Входные данные**: ID тележки размещения

**Выходные данные**: Информация о тележке размещения и ее содержимом

**Статус тележки в начале шага**: `occupied`

### 2. Выбор места хранения

**Описание**: Система предлагает оптимальные места хранения для каждого товара на основе различных факторов.

**Факторы, влияющие на выбор ячейки**:
- Габариты и вес товара
- Категория товара и требования к условиям хранения
- Частота обращения к товару (ABC-анализ)
- Текущая заполненность ячеек
- Совместимость товаров

**Действия**:
- Система автоматически предлагает оптимальные ячейки
- Кладовщик может подтвердить или изменить предложенные ячейки
- Формирование оптимального маршрута размещения

**Логика реализована в системе**: Специальный API-эндпоинт не требуется, система предлагает оптимальные ячейки во время размещения

### 3. Сканирование ячейки

**Описание**: Кладовщик подходит к предложенной ячейке и сканирует ее штрихкод для подтверждения правильности размещения.

**Действия**:
- Перемещение к предложенной ячейке
- Сканирование штрихкода ячейки
- Проверка системой соответствия ячейки плану размещения

**Этот шаг реализуется непосредственно при размещении**: Кладовщик сканирует ячейку при физическом размещении товара

### 4. Физическое размещение

**Описание**: Кладовщик помещает товар в ячейку и подтверждает размещение в системе.

**Действия**:
- Физическое размещение товара в ячейке
- Указание количества размещаемого товара
- Подтверждение размещения в системе

**API Endpoint**: `POST /wms/v1/inventory/invoices/{invoiceId}/items/{itemId}/place`

**Входные данные**:
```json
{
  "locationId": "60d21b4667d0d8992e610c85",
  "quantity": 10
}
```

**Выходные данные**: Информация о созданной записи в инвентаре и обновленном статусе ячейки

**Статус ячейки после шага**: `reserved` или `occupied` (в зависимости от заполненности)

### 5. Обновление инвентаря

**Описание**: Система автоматически обновляет данные инвентаря на основе информации о размещении.

**Действия системы**:
- Создание новой записи в инвентаре или обновление существующей
- Обновление статуса и заполненности ячейки
- Обновление информации о размещенном количестве в тележке

**Этот шаг выполняется автоматически**: При успешном размещении система сама обновляет все необходимые данные

### 6. Завершение размещения

**Описание**: После размещения всех товаров из тележки кладовщик подтверждает завершение процесса.

**Действия**:
- Проверка, что все товары из тележки размещены
- Подтверждение завершения размещения
- Освобождение тележки для следующего использования

**Завершение происходит автоматически**: Когда все товары из тележки размещены, система автоматически меняет статус тележки на `free`

## Интеграция с другими процессами

### Связь с процессом приемки

Процесс размещения напрямую связан с приемкой через тележки размещения:

1. Во время приемки товары добавляются в тележку размещения
2. Тележка с принятыми товарами становится доступной для размещения
3. После размещения всех товаров информация о завершении процесса отражается в статусе принятой накладной

### Связь с управлением инвентарем

При размещении товаров система автоматически обновляет данные инвентаря:

1. Создаются записи, связывающие товары с ячейками
2. Обновляется информация о доступных остатках
3. Размещенные товары становятся доступными для резервирования и сборки

## Типы размещения

### Стандартное размещение

- **Описание**: Базовое размещение товаров по предложенным системой ячейкам
- **Особенности**: Система предлагает оптимальные ячейки, кладовщик подтверждает размещение

### Динамическое размещение

- **Описание**: Размещение товаров в любых подходящих ячейках на усмотрение кладовщика
- **Особенности**: Кладовщик самостоятельно выбирает ячейки в пределах допустимых зон

### Фиксированное размещение

- **Описание**: Размещение товаров в заранее закрепленные за ними ячейки
- **Особенности**: Для некоторых товаров могут быть жестко заданы места хранения

## Обработка исключительных ситуаций

### Нехватка места в предложенной ячейке

**Сценарий**: При попытке размещения оказывается, что в предложенной ячейке недостаточно места.

**Решение**:
1. Система выдает уведомление о нехватке места
2. Автоматически предлагается альтернативная ячейка
3. Кладовщик подтверждает новое место размещения

**API реализация**: При попытке разместить товар система проверяет доступную емкость ячейки и возвращает ошибку, если места недостаточно:

```json
{
  "error": "Insufficient capacity in location. Available: 5, Requested: 10"
}
```

### Ячейка недоступна или повреждена

**Сценарий**: При подходе к ячейке обнаруживается, что она недоступна или повреждена.

**Решение**:
1. Кладовщик отмечает ячейку как недоступную
2. Система предлагает альтернативное место размещения
3. Супервизор получает уведомление о проблеме с ячейкой

### Размещение не полного количества

**Сценарий**: Кладовщик размещает только часть товаров из тележки в конкретную ячейку.

**Решение**:
1. Кладовщик указывает фактическое размещаемое количество
2. Система обновляет данные о размещенном количестве в тележке
3. Оставшееся количество ожидает размещения в другие ячейки

## Метрики и KPI

### Основные показатели эффективности

1. **Время размещения**:
   - Среднее время от начала до завершения размещения одной тележки
   - Целевое значение: < 20 минут на тележку с 10 позициями

2. **Точность размещения**:
   - Процент товаров, размещенных в предложенные системой ячейки
   - Целевое значение: > 90%

3. **Эффективность использования пространства**:
   - Средняя заполненность ячеек
   - Целевое значение: > 70%

### Мониторинг процесса

Система автоматически отслеживает:
- Количество тележек, ожидающих размещения
- Среднее время размещения
- Эффективность использования складского пространства
- Отклонения от рекомендованных мест размещения

## Оптимизация процесса

### Рекомендации по повышению эффективности

1. **ABC-анализ товаров**:
   - Категоризация товаров по частоте обращения
   - Размещение часто используемых товаров в наиболее доступных зонах

2. **Зонирование склада**:
   - Выделение специализированных зон для разных категорий товаров
   - Оптимизация маршрутов перемещения

3. **Правило FIFO (First In, First Out)**:
   - Размещение новых партий товаров с учетом даты поступления
   - Обеспечение использования более старых партий в первую очередь

4. **Минимизация фрагментации**:
   - Стремление размещать одинаковые товары в соседних ячейках
   - Избегание размещения одного товара в множестве разных ячеек

## Примеры использования API

### Пример получения информации о тележке размещения

```bash
curl -X GET https://example.com/wms/v1/placement-carts/60d21b4667d0d8992e610c86
```

### Пример размещения товара

```bash
curl -X POST https://example.com/wms/v1/inventory/invoices/60d21b4667d0d8992e610c85/items/item-001/place \
  -H "Content-Type: application/json" \
  -d '{
    "locationId": "60d21b4667d0d8992e610c87",
    "quantity": 10
  }'
```

## Схема выбора оптимальной ячейки

Система использует следующий алгоритм для выбора оптимальной ячейки:

1. **Фильтрация по размеру**:
   - Учет физических габаритов товара
   - Выбор ячеек с достаточной вместимостью

2. **Проверка совместимости**:
   - Учет требований к условиям хранения
   - Проверка совместимости с другими товарами в ячейке

3. **Оптимизация доступа**:
   - Оценка частоты использования товара
   - Приоритет ячеек с удобным доступом для часто используемых товаров

4. **Минимизация фрагментации**:
   - Приоритет ячеек, где уже есть такой же товар
   - Выбор ячеек в той же зоне, где хранятся аналогичные товары

5. **Маршрутизация**:
   - Оптимизация маршрута размещения для всех товаров в тележке
   - Минимизация перемещений кладовщика

## Влияние на эффективность склада

Правильно организованный процесс размещения оказывает значительное влияние на общую эффективность склада:

1. **Повышение скорости сборки заказов**:
   - Оптимальное размещение сокращает время поиска и извлечения товаров
   - Сокращение маршрутов перемещения при сборке

2. **Оптимизация использования пространства**:
   - Максимальное использование доступного объема склада
   - Снижение потребности в расширении складских площадей

3. **Снижение ошибок**:
   - Четкая система размещения снижает риск человеческой ошибки
   - Автоматический контроль правильности размещения
